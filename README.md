# SplitVPN Docker

–ü—Ä–æ–µ–∫—Ç –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è/–æ—Ç–∫–ª—é—á–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ split tunneling —á–µ—Ä–µ–∑ Docker. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è Amnezia VPN, WireGuard –∏–ª–∏ OpenVPN, —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ–≥–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, DigitalOcean).

## üîß –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç

- –ß–∏—Ç–∞–µ—Ç IP-–∞–¥—Ä–µ—Å–∞ –∏–∑ `ip-list.json`
- –î–æ–±–∞–≤–ª—è–µ—Ç –º–∞—Ä—à—Ä—É—Ç—ã –∫ –Ω–∏–º —á–µ—Ä–µ–∑ VPN-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `amn0`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ `splitvpn`
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å split tunneling —á–µ—Ä–µ–∑ –∑–∞–ø—É—Å–∫ `docker-compose up`

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ ip-list.json            # –§–∞–π–ª —Å–æ —Å–ø–∏—Å–∫–æ–º IP, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –∏–¥—Ç–∏ —á–µ—Ä–µ–∑ VPN
‚îî‚îÄ‚îÄ toggle_split_tunneling.sh
```

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª—ã –≤—Ä—É—á–Ω—É—é
2. –ó–∞–º–µ–Ω–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `ip-list.json` —Å–≤–æ–∏–º —Å–ø–∏—Å–∫–æ–º IP-–∞–¥—Ä–µ—Å–æ–≤

–ü—Ä–∏–º–µ—Ä `ip-list.json`:
```json
{
  "google": ["8.8.8.8", "8.8.4.4"],
  "cloudflare": ["1.1.1.1"]
}
```

## üöÄ –ó–∞–ø—É—Å–∫

```bash
docker compose up --build
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:

- –≤–∫–ª—é—á–∏—Ç –º–∞—Ä—à—Ä—É—Ç—ã –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
- –æ—Ç–∫–ª—é—á–∏—Ç –º–∞—Ä—à—Ä—É—Ç—ã –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∑–∞–ø—É—Å–∫–µ (–µ—Å–ª–∏ –æ–Ω–∏ —É–∂–µ –±—ã–ª–∏ –∞–∫—Ç–∏–≤–Ω—ã)

## üìé –í–∞–∂–Ω–æ

–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è —Å:
- `--network=host` ‚Äî —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –º–∞—Ä—à—Ä—É—Ç–∞–º–∏ —Ö–æ—Å—Ç–∞
- `--cap-add=NET_ADMIN` ‚Äî —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å iproute2 –≤–Ω—É—Ç—Ä–∏

## üí° –†–∞—Å—à–∏—Ä–µ–Ω–∏—è

–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:

- REST API –Ω–∞ Flask/FastAPI
- –ø–æ–¥–¥–µ—Ä–∂–∫—É –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∑–∞–ø—É—Å–∫–∞ (MODE=on|off)
- –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–æ–≤ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é

---

**–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `amn0`  
**–ü–æ–¥—Å–µ—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤ VPN:** `172.29.172.0/24`

–ò–∑–º–µ–Ω–∏—Ç–µ —ç—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –≤ `toggle_split_tunneling.sh`, –µ—Å–ª–∏ —É –≤–∞—Å –æ–Ω–∏ –¥—Ä—É–≥–∏–µ.